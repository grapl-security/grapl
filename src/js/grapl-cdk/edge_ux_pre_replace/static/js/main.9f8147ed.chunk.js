(this["webpackJsonpgrapl-fe"]=this["webpackJsonpgrapl-fe"]||[]).push([[0],{158:function(e,n,t){},197:function(e,n,t){e.exports=t(272)},202:function(e,n,t){},272:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(17),o=t.n(c),s=(t(202),t(180)),l=t(335),i=(t(158),t(7)),u=t.n(i),d=t(12),f=t(9),m=t(16),p=t(133),g=t(53),b=t(308),h=t(339),v=Object(b.a)((function(e){return Object(h.a)({valErrorMsg:{marginLeft:".8rem",color:"red",fontSize:".75rem"}})})),y={auth:"auth",graphQL:"graphQlEndpoint",modelPluginEdge:"modelPluginDeployer"},E=function(){var e=Object(f.a)(u.a.mark((function e(n){var t,a,r=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>1&&void 0!==r[1]?r[1]:"GET",e.next=3,fetch(n,{method:t,credentials:"include",headers:new Headers({"Content-Type":"application/json"})}).catch((function(e){throw console.warn(e),new Error("API Request Error: ".concat(e))}));case 3:return a=e.sent,e.abrupt("return",a.json());case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),w=function(){var e=Object(f.a)(u.a.mark((function e(n){var t,a,r,c=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>1&&void 0!==c[1]?c[1]:"POST",a=c.length>2?c[2]:void 0,e.next=4,fetch(n,{method:t,credentials:"include",headers:new Headers({"Content-Type":"application/json"}),body:a}).catch((function(e){throw console.warn(e),new Error("Error with Post Request: ".concat(e))}));case 4:return r=e.sent,e.abrupt("return",r.json());case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=function(){var e=Object(f.a)(u.a.mark((function e(n,t){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.stringify({username:n,password:t}),e.prev=1,e.next=4,w("".concat(y.auth,"/login"),"post",a);case 4:return r=e.sent,e.abrupt("return","True"===r.success);case 8:return e.prev=8,e.t0=e.catch(1),console.log("Login Error",e.t0),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n,t){return e.apply(this,arguments)}}();function x(e){return j.apply(this,arguments)}function j(){return(j=Object(f.a)(u.a.mark((function e(n){var t,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(new TextEncoder).encode(n),e.next=3,crypto.subtle.digest("SHA-256",t);case 3:return a=e.sent,r=Array.from(new Uint8Array(a)),e.abrupt("return",r.map((function(e){return("00"+e.toString(16)).slice(-2)})).join(""));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=function(){var e=Object(f.a)(u.a.mark((function e(n,t){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"f1dafbdcab924862a198deaa5b6bae29aef7f2a442f841da975f1c515529d254",e.next=3,x(t+"f1dafbdcab924862a198deaa5b6bae29aef7f2a442f841da975f1c515529d254"+n);case 3:a=e.sent,r=0;case 5:if(!(r<5e3)){e.next=12;break}return e.next=8,x(a);case 8:a=e.sent;case 9:r++,e.next=5;break;case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),N=function(e){var n=v(),t=p.a().shape({userName:p.b().required("Username Required"),password:p.b().required("Password Required")}),a=r.a.useState({loginFailed:!1}),c=Object(m.a)(a,2),o=c[0],s=c[1];return r.a.createElement("div",{className:"backgroundImage"},r.a.createElement("div",{className:"grapl"}," Grapl "),r.a.createElement("div",{className:"formContainer"},r.a.createElement(g.c,{initialValues:{userName:"",password:""},validationSchema:t,onSubmit:function(){var e=Object(f.a)(u.a.mark((function e(n){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(n.userName,n.password);case 2:return t=e.sent,e.next=5,O(n.userName,t);case 5:!0===e.sent?(window.history.replaceState("#/login","","#/"),window.location.reload(),console.log("Logged In")):s(Object(d.a)(Object(d.a)({},o),{},{loginFailed:!0}));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},(function(e){var t=e.errors,a=e.touched;return r.a.createElement(g.b,null,r.a.createElement(g.a,{name:"userName",type:"text",placeholder:"Username"}),a.userName&&t.userName&&r.a.createElement("div",{className:n.valErrorMsg},t.userName),r.a.createElement(g.a,{name:"password",type:"password",placeholder:"Password"})," ",r.a.createElement("br",null),a.password&&t.password&&r.a.createElement("div",{className:n.valErrorMsg},t.password),r.a.createElement("button",{className:"submitBtn",type:"submit"},"Submit"),o.loginFailed&&r.a.createElement("div",{className:n.valErrorMsg},"Unsuccessful Login"))}))))},S=t(10),_=t(44),P=t(5),C=t(340),F=t(330),I=t(326),L=t(327),A=t(329),T=t(325),D=t(175),M=t.n(D),R=t(324),z=t(127),U=t.n(z),B=t(179),H=function(e){return e>=0&&e<=25?"#02D084":e>=26&&e<=50?"#13A5E3":e>=51&&e<=75?"#FFD773":e>=76&&e<=100?"#E50F14":void 0},W=t(104),q=t(14),G=function(e,n){var t=e,a=0,r=n.map((function(e){return e||0})).sort((function(e,n){return e-n}));if("object"===typeof e&&(t=e.risk),void 0===t||0===t||0===r.length)return 0;var c,o=Object(q.a)(r);try{for(o.s();!(c=o.n()).done;){t>=c.value&&(a+=1)}}catch(s){o.e(s)}finally{o.f()}return Math.floor(a/r.length*100)},J=function(e,n){var t,a=Object(q.a)(n||[]);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r.id===e)return r}}catch(c){a.e(c)}finally{a.f()}return null},Q=function(e,n){var t=function(e,n){var t=J(e.source,n.nodes)||J(e.source.name,n.nodes),a=J(e.target,n.nodes)||J(e.target.name,n.nodes),r=t.risk_score||0,c=a.risk_score||0;return t&&a?Math.round((r+c)/2):(console.error("Missing srcNode/dstNode",t,e.source,a,n.nodes),0)}(e,n),a=Object(W.a)(n.nodes).map((function(e){return e.risk}));return G(t,a)},V=function(e,n){var t=Q(e,n);return H(t)},Y=function(e,n){var t=n;switch(e){case"Process":return t.process_name||t.process_id||"Process";case"Asset":return t.hostname||"Asset";case"File":return t.file_path||"File";case"IpAddress":return t.external_ip||"IpAddress";case"Lens":return t.lens_name||"Lens";default:return e||""}},$=function(e,n){var t=new Set;X(e,(function(a,r){n(e,a,r),function e(n,t,a){X(n,(function(r,c){t.has(n.uid+r+c.uid)||(t.add(n.uid+r+c.uid),a(n,r,c),e(c,t,a))}))}(r,t,n)}))},K=function(e,n){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=e[t];if(Array.isArray(a)){var r,c=Object(q.a)(a);try{for(c.s();!(r=c.n()).done;){var o=r.value;void 0!==o.uid&&n(t,o)}}catch(s){c.e(s)}finally{c.f()}}else a&&void 0!==a.uid&&n(t,a)}},X=function(e,n){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=e[t];if(Array.isArray(a)){var r,c=Object(q.a)(a);try{for(c.s();!(r=c.n()).done;){var o=r.value;void 0!==o.uid&&n(t,o)}}catch(s){c.e(s)}finally{c.f()}}else a&&void 0!==a.uid&&n(t,a)}},Z=function e(n,t){t(n),K(n,(function(n,a){e(a,t)}))},ee=function e(n,t){K(n,(function(a,r){t(n,a,r),e(r,t)}))},ne=new Set(["Process","File","IpAddress","Asset","Risk","IpConnections","ProcessInboundConnections","ProcessOutboundConnections"]),te=function(e){var n,t=Object(q.a)(e);try{for(t.s();!(n=t.n()).done;){var a=n.value;a.predicates&&$(a,(function(e,n,t){if(e.predicates&&!ne.has(e.predicates.dgraph_type[0])){var a=Object(d.a)({},e.predicates);delete e.predicates,Object.keys(a).forEach((function(n){e[n]=a[n]}))}if(t.predicates&&!ne.has(t.predicates.dgraph_type[0])){var r=Object(d.a)({},t.predicates);delete t.predicates,Object.keys(r).forEach((function(e){t[e]=r[e]}))}}))}}catch(r){t.e(r)}finally{t.f()}},ae=function(){var e=Object(f.a)(u.a.mark((function e(n){var t,a,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t='\n    {\n        lens_scope(lens_name: "'.concat(n,'") {\n            uid,\n            node_key,\n            lens_type,\n            dgraph_type,\n            score,\n            scope {\n                ... on Process {\n                    uid,\n                    node_key, \n                    dgraph_type,\n                    process_name, \n                    process_id,\n                    children {\n                        uid, \n                        node_key, \n                        dgraph_type,\n                        process_name, \n                        process_id,\n                    }, \n                    risks {  \n                        uid,\n                        dgraph_type,\n                        node_key, \n                        analyzer_name, \n                        risk_score\n                    },\n                }\n                ... on Asset {\n                    uid, \n                    node_key, \n                    dgraph_type,\n                    hostname,\n                    asset_ip{\n                        ip_address\n                    }, \n                    asset_processes{\n                        uid, \n                        node_key, \n                        dgraph_type,\n                        process_name, \n                        process_id,\n                    },\n                    files_on_asset{\n                        uid, \n                        node_key, \n                        dgraph_type,\n                        file_path\n                    }, \n                    risks {  \n                        uid,\n                        dgraph_type,\n                        node_key, \n                        analyzer_name, \n                        risk_score\n                    },\n                }\n                ... on File {\n                    uid,\n                    node_key, \n                    dgraph_type,\n                    risks {  \n                        uid,\n                        dgraph_type,\n                        node_key, \n                        analyzer_name, \n                        risk_score\n                    },\n                }\n                ... on PluginType {\n                    predicates,\n                }\n            }\n        }\n    }\n'),a=JSON.stringify({query:t}),e.next=4,w("".concat(y.graphQL,"/graphql"),"POST",a).then((function(e){return e})).then((function(e){return e.errors&&console.log("Unable to retrieve graph data ",e.errors),e})).then((function(e){return e.data})).then((function(e){return e.lens_scope.scope}));case 4:return r=e.sent,e.next=7,r;case 7:return c=e.sent,te(c),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),re=function(e){var n=e.dgraph_type;return n?Array.isArray(n)?n[0]:n:(console.warn("Unable to find type for node ",e),"Unknown Type")},ce=function(e){var n,t=[],a=[],r=new Map,c=Object(q.a)(e);try{for(c.s();!(n=c.n()).done;){var o=n.value;ee(o,(function(e,n,t){if("scope"!==n){if("Unknown"===re(e)||"Unknown"===re(t)||"Risk"===re(e)||"Risk"===re(t))return;a.push({source:e.uid,name:n,target:t.uid})}})),Z(o,(function(e){var n=re(e);if("Unknown"!==n&&"Risk"!==n){var t,a=Y(n,e),c=Object(d.a)({},e),o=e.risk||0,s="",l=e.risks||[],i=Object(q.a)(l);try{for(i.s();!(t=i.n()).done;){var u=t.value;o+=u.risk_score||0,s&&u.analyzer_name&&(s+=", "),s+=u.analyzer_name||""}}catch(m){i.e(m)}finally{i.f()}K(e,(function(e,n){c[e]=void 0}));var f=Object(d.a)(Object(d.a)({name:e.uid},c),{},{risk_score:o,analyzerNames:s,id:e.uid,nodeType:n,nodeLabel:a});r.set(e.uid,f)}}))}}catch(f){c.e(f)}finally{c.f()}var s,l={},i=Object(q.a)(r.values());try{for(i.s();!(s=i.n()).done;){var u=s.value;t.push(u),l[u.uid]||(l[u.uid]=u)}}catch(f){i.e(f)}finally{i.f()}return{nodes:t,links:a,index:l}},oe=function(e,n){for(var t in e){var a=e[t];Object.prototype.hasOwnProperty.call(e,t)&&(Array.isArray(a)?a.length>0&&void 0===a[0].uid&&n(t):n(t))}},se=function(e,n){var t=!1,a={};for(var r in e)"fx"!==r&&"fy"!==r&&"links"!==r&&"neighbors"!==r&&"vx"!==r&&"vy"!==r&&"x"!==r&&"y"!==r&&"vx"!==r&&"vy"!==r&&(a[r]=e[r]);var c=a;return oe(n,(function(e){Object.prototype.hasOwnProperty.call(c,e)||c[e]!==n[e]&&(c[e]=n[e],t=!0)})),t},le=function(e,n){if(!n.nodes&&!n.links)return null;var t,a=!1,r={nodes:[],links:[],index:{}},c=new Map,o=new Map,s=Object(q.a)(e.nodes);try{for(s.s();!(t=s.n()).done;){var l=t.value;c.set(l.uid,l)}}catch(k){s.e(k)}finally{s.f()}var i,u=Object(q.a)(n.nodes);try{for(u.s();!(i=u.n()).done;){var d=i.value,f=c.get(d.uid);f?se(f,d)&&(a=!0):(c.set(d.uid,d),a=!0)}}catch(k){u.e(k)}finally{u.f()}var m,p=Object(q.a)(e.links);try{for(p.s();!(m=p.n()).done;){var g=m.value;if(g){var b=g,h=b.source.uid+g.name+b.target.uid;o.set(h,g)}}}catch(k){p.e(k)}finally{p.f()}var v,y=Object(q.a)(n.links);try{for(y.s();!(v=y.n()).done;){var E=v.value,w=E.source+E.name+E.target;o.get(w)||(o.set(E.source+E.name+E.target,E),a=!0)}}catch(k){y.e(k)}finally{y.f()}r.nodes=Array.from(c.values()),r.links=Array.from(o.values());var O,x=Object(q.a)(r.nodes);try{for(x.s();!(O=x.n()).done;){var j=O.value;r.index[j.uid]=j}}catch(k){x.e(k)}finally{x.f()}return r.links.forEach((function(e){var n=r.index[e.source],t=r.index[e.target];void 0!==n&&void 0!==!t&&(!n.neighbors&&(n.neighbors=new Set),!t.neighbors&&(t.neighbors=new Set),n.neighbors.add(t),t.neighbors.add(n),!n.links&&(n.links=new Set),!t.links&&(t.links=new Set),n.links.add(e),t.links.add(e))})),a?r:null},ie=function(){var e=Object(f.a)(u.a.mark((function e(n,t,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return console.log("No lens names"),e.abrupt("return");case 3:return r=t.curLensName,e.next=6,ae(n).then(function(){var e=Object(f.a)(u.a.mark((function e(c){var o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=ce(c),null!==(s=le(t.graphData,o))&&a(r===n?Object(d.a)(Object(d.a)({},t),{},{curLensName:n,graphData:s}):Object(d.a)(Object(d.a)({},t),{},{curLensName:n,graphData:o}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){return console.error("Failed to retrieveGraph ",e)}));case 6:case"end":return e.stop()}}),e)})));return function(n,t,a){return e.apply(this,arguments)}}(),ue="#FADA63",de="#42C6FF",fe="rgba(0, 0, 0, 0.8)",me="#ffffff",pe="#919191",ge="#F1F1F1",be=function(e){var n=e.lensName,t=e.setCurNode,c=Object(a.useRef)(),o=Object(a.useState)(function(e){return{graphData:{nodes:[],links:[],index:{}},curLensName:e}}(n)),s=Object(m.a)(o,2),l=s[0],i=s[1];Object(a.useEffect)((function(){var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}return e.next=3,ie(n,l,i);case 3:console.log("Updating graph for lens: ",n);case 4:case"end":return e.stop()}}),e)}))),1e3);return function(){clearInterval(e)}}),[n,l,i]);var d=Object(a.useMemo)((function(){return l.graphData}),[l]),p=Object(a.useState)(null),g=Object(m.a)(p,2),b=g[0],h=g[1],v=Object(a.useState)(new Set),y=Object(m.a)(v,2),E=y[0],w=y[1],O=Object(a.useState)(new Set),x=Object(m.a)(O,2),j=x[0],k=x[1],N=Object(a.useState)(null),S=Object(m.a)(N,2),_=S[0],P=S[1],C=function(){w(E),k(j)},F=Object(a.useCallback)((function(e,n){var a=e,r=a.links,c=a.neighbors;delete a.links,delete a.neighbors,t(a),h(a||null),a.links=r,a.neighbors=c}),[t,h]),I=Object(a.useCallback)((function(e,n){if(E.clear(),j.clear(),e){var t=e;if(E.add(t),!t.neighbors)return;t.neighbors.forEach((function(e){E.add(e)})),t.links.forEach((function(e){j.add(e)}))}P(e||null),C()}),[P,C]),L=Object(a.useCallback)((function(e,n){e.fx=e.x,e.fy=e.y,n.save();var t=function(e,n){var t=Object(W.a)(n.nodes).map((function(e){return e.risk})),a=G(e.risk_score,t);return a>=75?7:a>=50?6:a>=25?5:4}(e,d);n.beginPath(),n.arc(e.x,e.y,1.4*t,0,2*Math.PI,!1),n.fillStyle=e===_?ue:H(e.risk_score),n.fill(),n.save(),n.beginPath(),n.arc(e.x,e.y,1.2*t,0,2*Math.PI,!1),n.fillStyle=e===b?de:function(e){switch(e){case"Asset":return"rgba(251, 154, 153, .8)";case"File":return"rgba(236, 189, 169, .8)";case"IpAddress":return"rgba(253, 191, 111, .8)";case"IpConnections":return"rgba(255, 241, 150, .8)";case"IpPort":return"rgba(178, 223, 138, .8)";case"NetworkConnection":return"rgba(166, 206, 227, .8)";case"Process":return"rgba(31, 120, 180, .8)";case"ProcessInboundConnection":return"rgba(202, 178, 214, .8)";case"ProcessOutboundConnection":return"rgba(106, 61, 154, .8)";case"Risk":return"rgba(238, 238, 238, .8)";default:return"#42C6FF"}}(e.dgraph_type[0]),n.fill(),n.save();var a=e.nodeLabel,r=Math.min(98,t/n.measureText(a).width);n.font="".concat(r+5,"px Roboto");var c=[n.measureText(a).width,r].map((function(e){return e+.2*r}));n.fillStyle=fe,n.fillRect(e.x-c[0]/2,e.y-c[1]-2.75,c[0]+1.25,c[1]+5.5),n.textAlign="center",n.textBaseline="middle",n.fillStyle=me,n.fillText(a,e.x,e.y),n.save()}),[d,b,_]);return r.a.createElement(B.a,{graphData:d,ref:c,nodeLabel:"nodeLabel",nodeCanvasObject:L,nodeCanvasObjectMode:function(){return"after"},onNodeHover:I,onNodeClick:F,onNodeDragEnd:function(e){e.fx=e.x,e.fy=e.y},linkColor:function(e){return j.has(e)?ge:V(e,d)},linkWidth:function(e){return j.has(e)?5:4},linkDirectionalArrowLength:10,linkDirectionalArrowRelPos:function(e){return function(e,n){var t=J(e.target.uid,n.nodes);if(null===t||0===t.risk)return 1;var a=Object(W.a)(n.nodes).map((function(e){return e.risk})),r=G(t.risk_score,a);return r>=75?.95:r>=50?.9:r>=25?.85:1}(e,d)},linkDirectionalParticleSpeed:.005,linkDirectionalParticleColor:function(e){return pe},linkDirectionalParticles:1,linkDirectionalParticleWidth:function(e){return j.has(e)?4:function(e,n){var t=Q(e,n);return t>=75?5:t>=50?4:t>=25?3:2}(e,d)+1},linkCanvasObjectMode:function(){return"after"},linkCanvasObject:function(e,n){var t=e.source,a=e.target;if(e.color=V(e,d),"object"===typeof t&&"object"===typeof a){var r={x:t.x+(a.x-t.x)/2,y:t.y+(a.y-t.y)/2},c={x:a.x-t.x,y:a.y-t.y},o=Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2))-96,s=Math.atan2(c.y,c.x);s>Math.PI/2&&(s=-(Math.PI-s)),s<-Math.PI/2&&(s=-(-Math.PI-s));var l,i="children"===(l=e.name)?"executed":l;n.font="50px Roboto";var u=Math.min(8,o/n.measureText(i).width);n.font="".concat(u+5,"px Roboto"),n.save(),n.translate(r.x,r.y),n.rotate(s),n.textAlign="center",n.textBaseline="middle",n.fillText(i,.75,3),n.restore()}},onLinkHover:function(e){E.clear(),j.clear(),e&&(j.add(e),E.add(e.source),E.add(e.target))},warmupTicks:100,cooldownTicks:100})},he=t(322),ve=t(323),ye=t(320),Ee=t(321),we=t(319),Oe=t(317);var xe=Object(b.a)({root:{fontSize:".75em"},nodeTable:{minWidth:450},tableHeader:{fontSize:".85rem",backgroundColor:"#595959"},nodeTableData:{fontSize:".75rem"}});var je=function(e){var n=e.node,t=xe(),a=new Set(["id","dgraph.type","dgraph_type","__indexColor","risks","uid","scope","name","nodeType","nodeLabel","x","y","index","vy","vx","fx","fy"]);X(n,(function(e,n){a.add(e)}));var c={};return oe(n,(function(e){var t=n[e];if(!a.has(e)&&t)if(e.includes("_time"))try{c[e]=new Date(t).toLocaleString()}catch(r){c[e]=t}else c[e]=t})),r.a.createElement(Ee.a,null,r.a.createElement(he.a,{className:t.nodeTable},function(e,n){return e?r.a.createElement(Oe.a,null,r.a.createElement(we.a,null,r.a.createElement(ye.a,{align:"left",className:n.tableHeader},r.a.createElement("b",null," Property ")),r.a.createElement(ye.a,{align:"right",className:n.tableHeader},r.a.createElement("b",null," Value ")))):r.a.createElement(r.a.Fragment,null)}(n,t),r.a.createElement(ve.a,null,Object.entries(c).map((function(e){var a=Object(m.a)(e,2),c=a[0],o=a[1];return r.a.createElement(we.a,{key:n.node_key+c},r.a.createElement(ye.a,{className:t.nodeTableData,align:"left"},r.a.createElement("b",null,c)),r.a.createElement(ye.a,{className:t.nodeTableData,align:"right"},o))})))))},ke=t(124),Ne=t.n(ke),Se=t(123),_e=t.n(Se),Pe=t(341),Ce=t(328),Fe=t(337),Ie=Object(b.a)({root:{fontSize:"1rem"},backdrop:{color:"#fff",backgroundColor:"transparent",width:"80%"},button:{width:".05%",height:"50%",color:"white",margin:".5rem",backgroundColor:"#424242"},title:{margin:"1rem",fontSize:"1.1rem",color:"#42C6FF"},expand:{color:"#42C6FF",margin:"0px",width:"2rem",height:"2rem"},header:{display:"flex"},table:{minWidth:450},lensName:{fontSize:".75rem"},pagination:{margin:".5rem",backgroundColor:"#595959"},head:{color:"white",fontSize:".75rem"}});function Le(e){var n=Ie();return r.a.createElement(we.a,{key:e.uid},r.a.createElement(ye.a,{component:"th",scope:"row",align:"left"},r.a.createElement(R.a,{className:n.lensName,onClick:function(){e.setLens(e.lens)}},e.lens_type+" :\t\t"+e.lens)),r.a.createElement(ye.a,{component:"th",scope:"row",align:"right"},e.score))}var Ae=function(){var e=Object(f.a)(u.a.mark((function e(n,t){var a,r,c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="\n        {\n            lenses(first: ".concat(n,", offset: ").concat(t,") {\n                uid,\n                node_key,\n                lens_name,\n                score, \n                lens_type,\n            }\n        }\n    "),r=JSON.stringify({query:a}),e.next=4,w("".concat(y.graphQL,"/graphql"),"POST",r).then((function(e){return e})).then((function(e){return e.errors&&(console.error("Unable to retrieve lenses ",e.errors),e.data={lenses:[]}),e})).then((function(e){return e.data}));case 4:return c=e.sent,e.next=7,c;case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();function Te(e){var n=e.setLens,t=Ie(),c=Object(a.useState)(null),o=Object(m.a)(c,2),s=o[0],l=o[1],i=Object(a.useState)({toggled:!0,lenses:[],first:100,offset:0}),u=Object(m.a)(i,2),f=u[0],p=u[1],g=Object(a.useState)(0),b=Object(m.a)(g,2),h=b[0],v=b[1],y=Object(a.useState)(10),E=Object(m.a)(y,2),w=E[0],O=E[1];return Object(a.useEffect)((function(){var e=setInterval((function(){Ae(f.first,f.offset).then((function(e){if(e.lenses&&e.lenses!==f.lenses){var n=f.lenses.concat(e.lenses);l(n),p(Object(d.a)(Object(d.a)({},f),{},{offset:f.offset+e.lenses.length||0,lenses:n}))}}))}),1e3);return function(){return clearInterval(e)}})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.header},r.a.createElement("b",{className:t.title}," Lenses "),r.a.createElement(R.a,{className:t.button,onClick:function(){p(Object(d.a)(Object(d.a)({},f),{},{toggled:!f.toggled}))}},f.toggled?r.a.createElement(_e.a,{className:t.expand}):r.a.createElement(Ne.a,{className:t.expand}))),r.a.createElement("div",{className:"lensToggle"},s?f.toggled&&function(e,n,t,a,c,o,s){return r.a.createElement(Ee.a,null,r.a.createElement(Fe.a,{className:s.pagination,"aria-label":"pagination",rowsPerPageOptions:[5,10,25],component:"div",count:e.lenses.length,rowsPerPage:t,page:n,onChangePage:a,onChangeRowsPerPage:c}),e.lenses.slice(n*t,n*t+t).map((function(e){return r.a.createElement(he.a,{className:s.table,"aria-label":"lens table",key:Number(e.uid)},r.a.createElement(Oe.a,{className:s.head},r.a.createElement(we.a,null,r.a.createElement(ye.a,{align:"left"},r.a.createElement("b",null," Lens Name ")),r.a.createElement(ye.a,{align:"right"},r.a.createElement("b",null," Risk ")))),r.a.createElement(ve.a,null,r.a.createElement(Le,{key:Number(e.uid),uid:e.uid,lens:e.lens_name,lens_type:e.lens_type,score:e.score,setLens:o})))})))}(f,h,w,(function(e,n){v(n)}),(function(e){O(parseInt(e.target.value,10)),v(0)}),n,t):r.a.createElement(Pe.a,{className:t.backdrop,open:!0},r.a.createElement(Ce.a,{color:"inherit"}))),r.a.createElement(A.a,null))}function De(e){var n=e.curNode,t=Object(a.useState)(!0),c=Object(m.a)(t,2),o=c[0],s=c[1],l=Ie();return r.a.createElement("div",null,n&&r.a.createElement("div",{className:l.header},r.a.createElement("b",{className:l.title}," Node Details"),r.a.createElement(R.a,{className:l.button,onClick:function(){s((function(e){return!e}))}},!0===o?r.a.createElement(_e.a,{className:l.expand}):r.a.createElement(Ne.a,{className:l.expand}))),r.a.createElement("div",{className:"nodeToggle"},o&&n&&r.a.createElement("div",null,r.a.createElement(Me,{node:n}))))}var Me=function(e){var n=e.node;return r.a.createElement(r.a.Fragment,null," ",r.a.createElement(je,{node:n})," ")};function Re(e){var n=e.setLens,t=e.curNode;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Te,{setLens:n}),r.a.createElement(De,{curNode:t}))}var ze=Object(b.a)((function(e){return Object(h.a)({root:{display:"flex"},header:{justifyContent:"space-between"},link:{color:"#42C6FF",textDecoration:"none"}})})),Ue=function(e){var n=e.displayBtn,t=ze();return r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{position:"static"},r.a.createElement(I.a,{className:t.header},r.a.createElement(L.a,{variant:"h6"},"GRAPL"),n&&r.a.createElement(_.b,{to:"/",className:t.link},r.a.createElement(U.a,null)))))},Be=t(331),He=t(332),We=t(334),qe=t(333),Ge=Object(b.a)({root:{maxWidth:345,postion:"fixed"},button:{border:"2px solid white",backgroundColor:"#42c6ff"}});function Je(){var e=Ge();return r.a.createElement(Be.a,{variant:"outlined",className:e.root},r.a.createElement(He.a,null,r.a.createElement(qe.a,null,r.a.createElement(L.a,{variant:"body2",color:"textSecondary",component:"p"},"You are not logged in and changes cannot be saved."))),r.a.createElement(We.a,null,r.a.createElement(R.a,{className:e.button,size:"small",onClick:function(){window.history.replaceState("#/","","#/login"),window.location.reload()}}," Login ")))}var Qe=function(){var e=Object(f.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E("".concat(y.auth,"/checkLogin"),"post");case 3:return n=e.sent,e.abrupt("return","True"===n.success);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),Ve=Object(b.a)((function(e){return Object(h.a)({root:{display:"flex"},button:{backgroundColor:"#42C6FF",margin:"0.25rem",padding:"0.20rem"},loggedIn:{display:"flex",alignItems:"flex-end",justifyContent:"flex-end"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(500,"px)"),marginLeft:500,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2),color:"#42C6FF"},hide:{display:"none"},drawer:{width:500,flexShrink:0},drawerPaper:{width:500},drawerHeader:Object(d.a)(Object(d.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-500},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},lensName:{color:"#EAFDFF",fontSize:"1.5rem"},headerTitle:{fontSize:"35px"},headerContainer:{width:"100vw",display:"flex",justifyContent:"space-between"},close:{color:"#42C6FF"},link:{color:"#42C6FF",textDecoration:"none"}})}));function Ye(e){var n=e.setLens,t=e.curLens,a=e.curNode,c=Ve(),o=r.a.useState(!0),s=Object(m.a)(o,2),l=s[0],i=s[1];return r.a.createElement("div",{className:c.root},r.a.createElement(F.a,{position:"fixed",className:Object(P.a)(c.appBar,Object(S.a)({},c.appBarShift,l))},r.a.createElement(I.a,null,r.a.createElement(T.a,{color:"inherit","aria-label":"open drawer",onClick:function(){i(!0)},edge:"start",className:Object(P.a)(c.menuButton,l&&c.hide)},"\u2630"),r.a.createElement("div",{className:c.headerContainer},r.a.createElement(L.a,{variant:"h5",noWrap:!0},r.a.createElement("b",{className:c.headerTitle}," GRAPL ")),r.a.createElement(_.b,{to:"/",className:c.link},r.a.createElement(U.a,null))))),r.a.createElement(C.a,{className:c.drawer,variant:"persistent",anchor:"left",open:l,classes:{paper:c.drawerPaper}},r.a.createElement("div",{className:c.drawerHeader},r.a.createElement(R.a,{onClick:function(){i(!1)}},r.a.createElement(M.a,{className:c.close}))),r.a.createElement(A.a,null),r.a.createElement(Re,{setLens:n,curNode:a})),r.a.createElement("main",{className:Object(P.a)(c.content,Object(S.a)({},c.contentShift,l))},r.a.createElement("div",{className:c.drawerHeader}),r.a.createElement("h3",{className:c.lensName}," ",t||""," "),r.a.createElement(L.a,{paragraph:!0})))}var $e=function(){var e=Ve(),n=r.a.useState({curLens:"",curNode:null,loggedIn:!0,renderedOnce:!1}),t=Object(m.a)(n,2),c=t[0],o=t[1];Object(a.useEffect)((function(){if(!c.renderedOnce){var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe().then((function(e){e||console.warn("Logged out"),o(Object(d.a)(Object(d.a)({},c),{},{loggedIn:e||!1,renderedOnce:!0}))}));case 2:case"end":return e.stop()}}),e)}))),1e3);return function(){clearInterval(e)}}}),[c,o]);var s=c.loggedIn;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ye,{setLens:function(e){return o(Object(d.a)(Object(d.a)({},c),{},{curLens:e}))},curLens:c.curLens,curNode:c.curNode}),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e.loggedIn},s?"":r.a.createElement(Je,null)),r.a.createElement(be,{lensName:c.curLens,setCurNode:function(e){o(Object(d.a)(Object(d.a)({},c),{},{curNode:e}))}})))},Ke=t(176),Xe=Object(b.a)((function(e){return Object(h.a)({root:{display:"flex"},button:{backgroundColor:"#42C6FF",margin:"0.25rem",padding:"0.25rem"},welcome:{width:"70%",textAlign:"center",backgroundColor:"#373740",height:"100vh",color:"white"},loggedIn:{display:"flex",justifyContent:"flex-end",zIndex:100},nav:{margin:"2rem",width:"30%",display:"flex",flexDirection:"column"},dashboard:{display:"flex",flexDirection:"row"},link:{color:"white",textDecoration:"none",padding:".75rem",backgroundColor:"#42C6FF",margin:"1rem",textAlign:"center",borderRadius:".35rem",textTransform:"uppercase",fontWeight:"bolder"}})})),Ze=function(){var e=Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E("".concat(y.auth,"/getNotebook"),"post").then((function(e){return e.success.notebook_url})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),en=Xe;function nn(){var e=Object(Ke.a)(Ze,[]),n=en(),t=Object(a.useState)({loggedIn:!0,renderedOnce:!1}),c=Object(m.a)(t,2),o=c[0],s=c[1];Object(a.useEffect)((function(){if(!o.renderedOnce){var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe().then((function(e){e||console.warn("Logged out"),s({loggedIn:e||!1,renderedOnce:!0})}));case 2:case"end":return e.stop()}}),e)}))),2e3);return function(){clearInterval(e)}}}),[o,s]),console.log("state - loggedin",o.loggedIn);var l=o.loggedIn;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue,{displayBtn:!1}),r.a.createElement("div",{className:n.dashboard},r.a.createElement("section",{className:n.nav},r.a.createElement(_.b,{to:"/engagements",className:n.link}," Engagements "),r.a.createElement(_.b,{to:"/plugins",className:n.link}," Upload Plugin "),r.a.createElement(R.a,{onClick:function(){!e.loading&&e.result?window.open(e.result):alert("sagemaker url not ready")},className:n.link}," Open Engagement Notebook ")),r.a.createElement("section",{className:n.welcome},r.a.createElement("div",{className:n.loggedIn},l?"":r.a.createElement(Je,null)),r.a.createElement("h1",null," Welcome! "))))}var tn=t(177),an=t.n(tn),rn=function(){var e=Object(f.a)(u.a.mark((function e(n){var t,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.stringify(n),e.next=3,w("".concat(y.modelPluginEdge,"/deploy"),"post",t);case 3:return a=e.sent,e.next=6,a;case 6:return r=e.sent,e.abrupt("return",r.success.Success);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),cn=Object(b.a)((function(e){return Object(h.a)({root:{display:"flex"},formContainer:{color:"white",margin:"1rem"},btn:{backgroundColor:"#42C6FF",margin:"0.25rem",padding:"0.25rem",borderRadius:"6px"},loggedIn:{display:"flex",justifyContent:"flex-end"},inputFiles:{border:"none",width:"35vw"},upload:{display:"flex"},succMsg:{color:"#03dac6"},errMsg:{color:"#CF6679"},pluginTable:{backgroundColor:"#292929",margin:"1em",width:"50%",height:"100%",boxShadow:" 1.5px 1.5px #000000"},uploadFormContainer:{backgroundColor:"#292929",margin:"1em",width:"50%",height:"100%",boxShadow:"1.5px 1.5px #000000",display:"flex"},uploadForm:{fontFamily:"Arial",display:"flex",fontSize:".75rem"}})})),on=function(){var e=Object(f.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var a=new FileReader;return a.addEventListener("load",(function(n){if(null!==n.target){var a=n.target.result;if(null===a)return console.warn("Read pluginfile was null"),void t(null);e("string"===typeof a?a:(new TextDecoder).decode(a))}else console.warn("onload event was null")})),a.readAsText(n)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),sn=function(e){var n=e.status,t=cn();return!0===n?r.a.createElement("div",{className:t.succMsg},"Plugins Successfully Deployed!"):!1===n?r.a.createElement("div",{className:t.errMsg},"Upload Unsuccessful"):r.a.createElement("div",null)},ln=function(){var e=r.a.useState({curFiles:null,success:null}),n=Object(m.a)(e,2),t=n[0],a=n[1],c=cn();return r.a.createElement("div",{className:c.formContainer},r.a.createElement("h4",null,"UPLOAD DIRECTORY WITH PLUGINS:"),r.a.createElement(g.c,{initialValues:{filename:""},onSubmit:function(e){var n={},r=[],c=t.curFiles;if(null!==c){var o,s=Object(q.a)(c);try{var l=function(){var e=o.value,t=on(e).then((function(t){var a=e.webkitRelativePath||e.mozRelativePath;n[a]=t}));r.push(t)};for(s.s();!(o=s.n()).done;)l()}catch(u){s.e(u)}finally{s.f()}var i=!0;Promise.all(r).then((function(){return rn({plugins:n})})).then((function(e){i=i&&e})).then((function(){return a(Object(d.a)(Object(d.a)({},t),{},{success:i}))}))}else console.warn("Attempted to upload files without selecting any")}},r.a.createElement(g.b,{className:c.uploadForm},r.a.createElement(g.a,{className:c.inputFiles,name:"plugin",directory:"",webkitdirectory:"",mozdirectory:"",type:"file",multiple:!0,placeholder:"Plugin",onChange:function(e){a(Object(d.a)(Object(d.a)({},t),{},{curFiles:e.currentTarget.files}))}}),r.a.createElement(R.a,{className:"submitBtn",type:"submit"},r.a.createElement(an.a,{className:c.btn})))),r.a.createElement("br",null),r.a.createElement(sn,{status:t.success}))},un=t(178),dn=t.n(un),fn=function(){var e=Object(f.a)(u.a.mark((function e(){var n,t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E("".concat(y.modelPluginEdge,"/listModelPlugins"),"POST");case 3:return n=e.sent,console.log("getPluginList",n),t=n.success.plugin_list,e.abrupt("return",t);case 9:return e.prev=9,e.t0=e.catch(0),console.warn("Error retrieving pluginList",e.t0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),mn=function(){var e=Object(f.a)(u.a.mark((function e(n){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.stringify({plugins_to_delete:[n]}),e.prev=1,e.next=4,w("".concat(y.modelPluginEdge,"/deleteModelPlugin"),"post",t);case 4:return a=e.sent,e.next=7,a.success;case 7:return e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(1),console.warn("Error deleting plugin",e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n){return e.apply(this,arguments)}}(),pn=function(){var e=cn(),n=r.a.useState({rows:[],toggle:!0}),t=Object(m.a)(n,2),c=t[0],o=t[1],s=Object(a.useState)(0),l=Object(m.a)(s,2),i=l[0],p=l[1],g=Object(a.useState)(10),b=Object(m.a)(g,2),h=b[0],v=b[1],y=h-Math.min(h,c.rows.length-i*h);return Object(a.useEffect)((function(){try{var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fn().then((function(e){o({toggle:c.toggle,rows:e})}));case 2:case"end":return e.stop()}}),e)}))),1e3);return function(){return clearInterval(e)}}catch(n){console.error("Unable to retrieve plugin list",n)}}),[c.toggle]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee.a,null,r.a.createElement(he.a,null,r.a.createElement(Oe.a,null,r.a.createElement(we.a,{key:"plugin"},r.a.createElement(ye.a,{align:"left"},"PLUGINS"))),r.a.createElement(ve.a,{"aria-label":"PluginTable"},c.rows.slice(i*h,i*h+h).map((function(n){return r.a.createElement(we.a,{key:n},r.a.createElement(ye.a,{align:"right"},n,r.a.createElement(R.a,{onClick:function(){mn(n).then((function(){o(Object(d.a)(Object(d.a)({},c),{},{toggle:c.toggle&&!1})),console.log("Plugin Deleted")}))}},r.a.createElement(dn.a,{className:e.btn}))))})),y>0&&r.a.createElement(we.a,{style:{height:53*y}},r.a.createElement(ye.a,{colSpan:6})))),r.a.createElement(Fe.a,{"aria-label":"pagination",rowsPerPageOptions:[5,10,25],component:"div",count:c.rows.length,rowsPerPage:h,page:i,onChangePage:function(e,n){p(n)},onChangeRowsPerPage:function(e){v(parseInt(e.target.value,10)),p(0)}})))},gn=function(){var e=cn(),n=Object(a.useState)({loggedIn:!0,renderedOnce:!1}),t=Object(m.a)(n,2),c=t[0],o=t[1];Object(a.useEffect)((function(){if(!c.renderedOnce){var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe().then((function(e){e||console.warn("Logged Out"),o({loggedIn:e||!1,renderedOnce:!0})}));case 2:case"end":return e.stop()}}),e)}))),2e3);return function(){clearInterval(e)}}}),[c,o]);var s=c.loggedIn;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue,{displayBtn:!0}),r.a.createElement("div",{className:e.loggedIn},s?"":r.a.createElement(Je,null)),r.a.createElement("div",{className:e.upload},r.a.createElement("div",{className:e.uploadFormContainer},r.a.createElement(ln,null),r.a.createElement("div",{id:"message"})),r.a.createElement("div",{className:e.pluginTable},r.a.createElement(pn,null))))},bn=t(21);var hn=function(){return console.log("Grapl loaded"),r.a.createElement(_.a,null,r.a.createElement(bn.c,null,r.a.createElement(bn.a,{exact:!0,path:"/login",component:N}),r.a.createElement(bn.a,{exact:!0,path:"/",component:nn}),r.a.createElement(bn.a,{exact:!0,path:"/plugins",component:gn}),r.a.createElement(bn.a,{exact:!0,path:"/engagements",component:$e})))};function vn(){return console.log("Welcome to Grapl"),r.a.createElement(r.a.Fragment,null,r.a.createElement(hn,null))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var yn=Object(s.a)({palette:{type:"dark",primary:{main:"#373740"}}}),En=document.getElementById("root");o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_.a,null,r.a.createElement(l.a,{theme:yn},r.a.createElement(vn,null),","))),En),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[197,1,2]]]);
//# sourceMappingURL=main.9f8147ed.chunk.js.map