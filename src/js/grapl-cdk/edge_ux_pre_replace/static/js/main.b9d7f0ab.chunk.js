(this["webpackJsonpgrapl-fe"]=this["webpackJsonpgrapl-fe"]||[]).push([[0],{169:function(e,n,t){},219:function(e,n,t){e.exports=t(293)},224:function(e,n,t){},289:function(e,n){},293:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(18),o=t.n(c),l=(t(224),t(191)),s=t(356),i=(t(169),t(9)),u=t.n(i),d=t(12),f=t(16),p=t(20),m=t(139),g=t(56),h=t(333),b=t(361),v=Object(h.a)((function(e){return Object(b.a)({valErrorMsg:{marginLeft:".8rem",color:"red",fontSize:".75rem"}})})),y=m.a().shape({userName:m.b().required("Username Required"),password:m.b().required("Password Required")}),E=function(e){var n=v(),t=r.a.useState({loginFailed:!1}),a=Object(p.a)(t,2),c=a[0],o=a[1];return r.a.createElement("div",{className:"backgroundImage"},r.a.createElement("div",{className:"grapl"}," Grapl "),r.a.createElement("div",{className:"formContainer"},r.a.createElement(g.c,{initialValues:{userName:"",password:""},validationSchema:y,onSubmit:function(){var e=Object(f.a)(u.a.mark((function e(n){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(n.userName,n.password);case 2:return t=e.sent,e.next=5,x(n.userName,t);case 5:!0===e.sent?(window.history.replaceState("#/login","","#/"),window.location.reload(),console.log("Logged In")):o(Object(d.a)(Object(d.a)({},c),{},{loginFailed:!0}));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},(function(e){var t=e.errors,a=e.touched;return r.a.createElement(g.b,null,r.a.createElement(g.a,{name:"userName",type:"text",placeholder:"Username"}),a.userName&&t.userName&&r.a.createElement("div",{className:n.valErrorMsg},t.userName),r.a.createElement(g.a,{name:"password",type:"password",placeholder:"Password"})," ",r.a.createElement("br",null),a.password&&t.password&&r.a.createElement("div",{className:n.valErrorMsg},t.password),r.a.createElement("button",{className:"submitBtn",type:"submit"},"Submit"),c.loginFailed&&r.a.createElement("div",{className:n.valErrorMsg},"Unsuccessful Login"))}))))};function w(e){return O.apply(this,arguments)}function O(){return(O=Object(f.a)(u.a.mark((function e(n){var t,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(new TextEncoder).encode(n),e.next=3,crypto.subtle.digest("SHA-256",t);case 3:return a=e.sent,r=Array.from(new Uint8Array(a)),e.abrupt("return",r.map((function(e){return("00"+e.toString(16)).slice(-2)})).join(""));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j=function(){var e=Object(f.a)(u.a.mark((function e(n,t){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"f1dafbdcab924862a198deaa5b6bae29aef7f2a442f841da975f1c515529d254",e.next=3,w(t+"f1dafbdcab924862a198deaa5b6bae29aef7f2a442f841da975f1c515529d254"+n);case 3:a=e.sent,r=0;case 5:if(!(r<5e3)){e.next=12;break}return e.next=8,w(a);case 8:a=e.sent;case 9:r++,e.next=5;break;case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),x=function(){var e=Object(f.a)(u.a.mark((function e(n,t){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("logging in via /login"),e.next=4,fetch("/prod/auth/login",{method:"post",body:JSON.stringify({username:n,password:t}),headers:{"Content-Type":"application/json"},credentials:"include"});case 4:return a=e.sent,e.next=7,a.json();case 7:return r=e.sent,e.abrupt("return","True"===r.success);case 11:return e.prev=11,e.t0=e.catch(0),console.log("Login Error",e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,t){return e.apply(this,arguments)}}(),k=t(11),N=t(30),_=t(5),S=t(190),C=t(138),F=t(14),P=function(e,n){var t=e;"object"===typeof e&&(t=e.risk);var a=n.map((function(e){return e||0})).sort((function(e,n){return e-n}));if(void 0===t||0===t||0===a.length)return 0;var r,c=0,o=Object(F.a)(a);try{for(o.s();!(r=o.n()).done;){t>=r.value&&(c+=1)}}catch(l){o.e(l)}finally{o.f()}return Math.floor(c/a.length*100)},I=function(e,n){var t,a=Object(F.a)(n||[]);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r.id===e)return r}}catch(c){a.e(c)}finally{a.f()}return null},L=function(e,n){var t=function(e,n){var t=I(e.source,n.nodes)||I(e.source.name,n.nodes),a=I(e.target,n.nodes)||I(e.target.name,n.nodes);if(!t||!a)return console.error("Missing srcNode/dstNode",t,e.source,a,n.nodes),0;var r=t.risk||0,c=a.risk||0;return Math.round((r+c)/2)}(e,n),a=Object(N.a)(n.nodes).map((function(e){return e.risk}));return P(t,a)},A=function(e){var n=0;e+="x";for(var t=parseInt(65745979961613.07),a=0;a<e.length;a++)n>t&&(n=parseInt(n/137)),n=131*n+e.charCodeAt(a);return n},T=function(e,n){return"Process"===e.nodeType?[31,185,128]:"File"===e.nodeType?[177,93,255]:n.rgb(e.nodeType)},M=function(e){return"hsl(".concat(40*(100-e)/100,", 100%, 50%)")},D=function(e,n){var t=L(e,n);return 0===t?"white":M(t)},R=function(e,n){var t=new Set;U(e,(function(a,r){n(e,a,r),function e(n,t,a){U(n,(function(r,c){t.has(n.uid+r+c.uid)||(t.add(n.uid+r+c.uid),a(n,r,c),e(c,t,a))}))}(r,t,n)}))},z=function(e,n){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=e[t];if(Array.isArray(a)){var r,c=Object(F.a)(a);try{for(c.s();!(r=c.n()).done;){var o=r.value;void 0!==o.uid&&n(t,o)}}catch(l){c.e(l)}finally{c.f()}}else a&&void 0!==a.uid&&n(t,a)}},U=function(e,n){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=e[t];if(Array.isArray(a)){var r,c=Object(F.a)(a);try{for(c.s();!(r=c.n()).done;){var o=r.value;void 0!==o.uid&&n(t,o)}}catch(l){c.e(l)}finally{c.f()}}else a&&void 0!==a.uid&&n(t,a)}},B=new Set(["Process","File","IpAddress","Asset","Risk","IpConnections","ProcessInboundConnections","ProcessOutboundConnections"]),q=function(e){var n,t=Object(F.a)(e);try{for(t.s();!(n=t.n()).done;){var a=n.value;a.predicates&&R(a,(function(e,n,t){if(e.predicates&&!B.has(e.predicates.dgraph_type[0])){var a=Object(d.a)({},e.predicates);delete e.predicates,Object.keys(a).forEach((function(n){e[n]=a[n]}))}if(t.predicates&&!B.has(t.predicates.dgraph_type[0])){var r=Object(d.a)({},t.predicates);delete t.predicates,Object.keys(r).forEach((function(e){t[e]=r[e]}))}}))}}catch(r){t.e(r)}finally{t.f()}},W=function(){var e=Object(f.a)(u.a.mark((function e(n){var t,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=G(n),e.next=3,fetch("/prod/graphQlEndpoint/graphql",{method:"post",body:JSON.stringify({query:t}),headers:{"Content-Type":"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){return e.errors&&console.log("graphql query failed in retrieve graph, expand scope ln 63: ",e.errors),console.log("retrieveGraph res",e),e})).then((function(e){return e.data})).then((function(e){return e.lens_scope}));case 3:return a=e.sent,e.next=6,a;case 6:return r=e.sent,console.debug("LensWithScope: ",r),q(r.scope),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),G=function(e){return console.log("expanding scope for: ",e),'\n    {\n        lens_scope(lens_name: "'.concat(e,'") {\n            uid,\n            node_key,\n            lens_name,\n            lens_type,\n            dgraph_type,\n            scope {\n                ... on Process {\n                    uid,\n                    node_key, \n                    dgraph_type,\n                    process_name, \n                    process_id,\n                    children {\n                        uid, \n                        node_key, \n                        dgraph_type,\n                        process_name, \n                        process_id,\n                    }, \n                    risks {  \n                        uid,\n                        dgraph_type,\n                        node_key, \n                        analyzer_name, \n                        risk_score\n                    },\n                }\n            \n                ... on Asset {\n                    uid, \n                    node_key, \n                    dgraph_type,\n                    hostname,\n                    asset_ip{\n                        ip_address\n                    }, \n                    asset_processes{\n                        uid, \n                        node_key, \n                        dgraph_type,\n                        process_name, \n                        process_id,\n                    },\n                    files_on_asset{\n                        uid, \n                        node_key, \n                        dgraph_type,\n                        file_path\n                    }, \n                    risks {  \n                        uid,\n                        dgraph_type,\n                        node_key, \n                        analyzer_name, \n                        risk_score\n                    },\n                }\n\n                ... on File {\n                    uid,\n                    node_key, \n                    dgraph_type,\n                    risks {  \n                        uid,\n                        dgraph_type,\n                        node_key, \n                        analyzer_name, \n                        risk_score\n                    },\n                }\n\n                ... on PluginType {\n                    predicates,\n                }\n            }\n        }\n    }\n')},H=function(e,n){var t=!1;return Z(n,(function(a){Object.prototype.hasOwnProperty.call(e,a)||e[a]!==n[a]&&(e[a]=n[a],t=!0)})),t},J=function(e,n){if(!n.nodes&&!n.links)return null;var t,a={nodes:[],links:[]},r=!1,c=new Map,o=new Map,l=Object(F.a)(e.nodes);try{for(l.s();!(t=l.n()).done;){var s=t.value;c.set(s.uid,s)}}catch(j){l.e(j)}finally{l.f()}var i,u=Object(F.a)(n.nodes);try{for(u.s();!(i=u.n()).done;){var d=i.value,f=c.get(d.uid);f?H(f,d)&&(r=!0):(c.set(d.uid,d),console.debug("new node added ",d),r=!0)}}catch(j){u.e(j)}finally{u.f()}var p,m=Object(F.a)(e.links);try{for(m.s();!(p=m.n()).done;){var g=p.value;if(g){var h=g.source.uid||g.source,b=g.target.uid||g.target;o.set(h+g.label+b,g)}}}catch(j){m.e(j)}finally{m.f()}var v,y=Object(F.a)(n.links);try{for(y.s();!(v=y.n()).done;){var E=v.value,w=E.source||E.source,O=E.target||E.target;o.get(w+E.label+O)||(console.debug("newlink",E),o.set(E.source+E.label+E.target,E),r=!0)}}catch(j){y.e(j)}finally{y.f()}return a.nodes=Array.from(c.values()),a.links=Array.from(o.values()),r?a:null},V=function(e){var n=e.dgraph_type||e.node_type;return n?Array.isArray(n)?n[0]:n:(console.warn("Unable to find type for node ",e),"Unknown")};function Y(e,n){return Math.floor(Math.random()*(n-e+1)+e)}var Q=function(e){var n=[],t=[],a=new Map;!function e(n,t){z(n,(function(a,r){t(n,a,r),e(r,t)}))}(e,(function(e,n,a){if("scope"!==n){if("Unknown"===V(e))return;if("Unknown"===V(a))return;if("Risk"===V(e))return;if("Risk"===V(a))return;t.push({source:e.uid,label:n,target:a.uid})}})),function e(n,t){t(n),z(n,(function(n,a){e(a,t)}))}(e,(function(e){var n=V(e);if("Unknown"!==n&&"Risk"!==n){var t=function(e,n){console.log("nodetype",e);var t=n;switch(e){case"Process":return t.process_name||t.process_id||"Process";case"Asset":return t.hostname||"Asset";case"File":return t.file_path||"File";case"IpAddress":return t.external_ip||"IpAddress";case"Lens":return t.lens_name||"Lens";default:return e||""}}(n,e),r=Object(d.a)({},e);r.risk=r.risk||0,r.analyzer_names=r.analyzer_names||"";var c,o=Object(F.a)(e.risks||[]);try{for(o.s();!(c=o.n()).done;){var l=c.value;r.risk+=l.risk_score||0,r.analyzer_names&&l.analyzer_name&&(r.analyzer_names+=", "),r.analyzer_names+=l.analyzer_name||""}}catch(i){o.e(i)}finally{o.f()}z(e,(function(e,n){r[e]=void 0}));var s=Object(d.a)(Object(d.a)({name:e.uid,x:200+Y(1,5),y:150+Y(1,5)},r),{},{id:e.uid,nodeType:n,nodeLabel:t});a.set(e.uid,s)}}));var r,c=Object(F.a)(a.values());try{for(c.s();!(r=c.n()).done;){var o=r.value;n.push(o)}}catch(l){c.e(l)}finally{c.f()}return{nodes:n,links:t}},$=(t(289),function(e,n,t){var a=t<.5?t*(1+n):t+n-t*n,r=2*t-a;return[(e/=360)+1/3,e,e-1/3].map((function(e){return e<0&&e++,e>1&&e--,e=e<1/6?r+6*(a-r)*e:e<.5?a:e<2/3?r+6*(a-r)*(2/3-e):r,Math.round(255*e)}))}),K=function(e){return"[object Array]"===Object.prototype.toString.call(e)},X=function e(n){var t=this;Object(_.a)(this,e),this.hsl=function(e){var n,a,r=t.hash(e);if(t.hueRanges.length){var c=t.hueRanges[r%t.hueRanges.length];n=r/t.hueRanges.length%727*(c.max-c.min)/727+c.min}else n=r%359;return r=parseInt(r/360),a=t.S[r%t.S.length],r=parseInt(r/t.S.length),[n,a,t.L[r%t.L.length]]},this.rgb=function(e){var n=t.hsl(e);return $.apply(t,n)};var a=[(n=n||{}).lightness,n.saturation].map((function(e){return K(e=e||[.35,.5,.65])?e.concat():[e]}));this.L=a[0],this.S=a[1],"number"===typeof n.hue&&(n.hue={min:n.hue,max:n.hue}),"object"!==typeof n.hue||K(n.hue)||(n.hue=[n.hue]),"undefined"===typeof n.hue&&(n.hue=[]),this.hueRanges=n.hue.map((function(e){return{min:"undefined"===typeof e.min?0:e.min,max:"undefined"===typeof e.max?360:e.max}})),this.hash=n.hash||A},Z=function(e,n){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(Array.isArray(e[t])?e[t].length>0&&void 0===e[t][0].uid&&n(t):n(t))},ee=function(){var e=Object(f.a)(u.a.mark((function e(n,t,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return console.log("Attempted to fetch empty lensName"),e.abrupt("return");case 3:return r=t.curLensName,e.next=6,W(n).then(function(){var e=Object(f.a)(u.a.mark((function e(c){var o,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Q(c),console.debug("state: ",t),console.debug("update",o),null!==(l=J(t.graphData,o))&&(r===n?a(Object(d.a)(Object(d.a)({},t),{},{curLensName:n,graphData:l})):(console.log("Switched lens, updating graph",t.curLensName,"ln",n),a(Object(d.a)(Object(d.a)({},t),{},{curLensName:n,graphData:o}))));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){return console.error("Failed to retrieveGraph ",e)}));case 6:case"end":return e.stop()}}),e)})));return function(n,t,a){return e.apply(this,arguments)}}(),ne=function(e){var n=e.lensName,t=e.setCurNode,c=r.a.useState(function(e){return{graphData:{nodes:[],links:[]},curLensName:e,intervalMap:{}}}(n)),o=Object(p.a)(c,2),l=o[0],s=o[1],i=Object(a.useRef)(null);Object(a.useEffect)((function(){i.current.d3Force("link",C.b()),i.current.d3Force("collide",C.a(22)),i.current.d3Force("charge",C.c()),i.current.d3Force("box",(function(){l.graphData.nodes.forEach((function(e){var n=e.x||0,t=e.y||0;Math.abs(n)>1e3&&(e.vx*=-1),Math.abs(t)>1e3&&(e.vy*=-1)}))}))}),[l]),Object(a.useEffect)((function(){var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}return console.debug("updating graph"),e.next=4,ee(n,l,s);case 4:case"end":return e.stop()}}),e)}))),1e3);return console.debug("setting lensName",n),function(){clearInterval(e)}}),[n,l,s]);var d=l.graphData,m=new X({});return r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,{graphData:d,nodeLabel:function(e){return e.nodeLabel},enableNodeDrag:!0,linkDirectionalParticles:1,linkDirectionalParticleWidth:function(e){return function(e,n){var t=L(e,n);return t>=75?5:t>=50?4:t>=25?3:2}(e,d)},linkDirectionalParticleColor:function(e){return D(e,d)},linkDirectionalParticleSpeed:.005,onNodeClick:function(e,n){t(e)},linkDirectionalArrowLength:8,linkWidth:4,linkDirectionalArrowRelPos:function(e){return function(e,n){var t=I(e.target.name,n.nodes);if(null===t||0===t.risk)return 1;var a=Object(N.a)(n.nodes).map((function(e){return e.risk})),r=P(t.risk,a);return 0===r?1:r>=75?.95:r>=50?.9:r>=25?.85:1}(e,d)},linkCanvasObjectMode:function(){return"after"},linkCanvasObject:function(e,n){var t=e.source,a=e.target;if(e.color=D(e,d),"object"===typeof t&&"object"===typeof a){var r=Object.assign.apply(Object,Object(N.a)(["x","y"].map((function(e){return Object(k.a)({},e,t[e]+(a[e]-t[e])/2)})))),c={x:a.x-t.x,y:a.y-t.y},o=Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2))-96,l=Math.atan2(c.y,c.x);l>Math.PI/2&&(l=-(Math.PI-l)),l<-Math.PI/2&&(l=-(-Math.PI-l));var s=function(e){return"children"===e?"executed":e}(e.label);n.font="50px Arial";var i=Math.min(8,o/n.measureText(s).width);n.font="".concat(i+5,"px Arial");var u=n.measureText(s).width,f=[u+=Math.round(.25*u),i].map((function(e){return e+.2*i}));n.save(),n.translate(r.x,r.y),n.rotate(l),n.fillStyle="rgb(115,222,255,1)",n.fillRect.apply(n,[-f[0]/2,-f[1]/2].concat(Object(N.a)(f))),n.textAlign="center",n.textBaseline="middle",n.fillStyle="white",n.fillText(s,.75,3),n.restore()}},nodeCanvasObject:function(e,n,t){var a=function(e,n){var t=Object(N.a)(n.nodes).map((function(e){return e.risk})),a=P(e.risk,t);return a>=75?6:a>=25?5:4}(e,d);n.save(),n.beginPath(),n.arc(e.x,e.y,1.3*a,0,2*Math.PI,!1),n.fillStyle=function(e,n,t){var a=Object(N.a)(n.nodes).map((function(e){return e.risk})),r=P(e.risk,a);if(0===r){var c=T(e,t);return"rgba(".concat(c[0],", ").concat(c[1],", ").concat(c[2],", 1)")}return M(r)}(e,d,m),n.fill(),n.restore(),n.save(),n.beginPath(),n.arc(e.x,e.y,1.2*a,0,2*Math.PI,!1);var r=T(e,m);n.fillStyle="rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", 1)"),n.fill(),n.restore();var c=e.nodeLabel,o=15/t;n.font="".concat(o,"px Arial");var l=[n.measureText(c).width,o].map((function(e){return e+.2*o}));n.fillStyle="rgba(48, 48, 48, 0.8)",n.fillRect.apply(n,[e.x-l[0]/2,e.y-l[1]/2].concat(Object(N.a)(l))),n.textAlign="center",n.textBaseline="middle",n.fillStyle="white",n.fillText(c,e.x,e.y)},ref:i}))},te=t(344),ae=t(345),re=t(342),ce=t(343),oe=t(339),le=t(341),se=Object(h.a)({root:{fontSize:".75em"},nodeTable:{minWidth:450},tableHeader:{fontSize:".85rem",backgroundColor:"#595959"},nodeTableData:{fontSize:".75rem"}});var ie=function(e){var n=e.node,t=se(),a=new Set(["id","dgraph.type","dgraph_type","__indexColor","risks","uid","scope","name","nodeType","nodeLabel","x","y","index","vy","vx","fx","fy"]);U(n,(function(e,n){a.add(e)}));var c={};return Z(n,(function(e){var t=n[e];a.has(e)||t&&(e.includes("_time")?c[e]=new Date(t).toLocaleString():c[e]=t)})),r.a.createElement(ce.a,null,r.a.createElement(te.a,{className:t.nodeTable},function(e,n){return e?r.a.createElement(oe.a,null,r.a.createElement(le.a,null,r.a.createElement(re.a,{align:"left",className:n.tableHeader},r.a.createElement("b",null," PROPERTY ")),r.a.createElement(re.a,{align:"left",className:n.tableHeader},r.a.createElement("b",null," VALUE ")))):r.a.createElement(r.a.Fragment,null)}(n,t),r.a.createElement(ae.a,null,Object.entries(c).map((function(e){var a=Object(p.a)(e,2),c=a[0],o=a[1];return r.a.createElement(le.a,{key:n.node_key+c},r.a.createElement(re.a,{className:t.nodeTableData,align:"left"},r.a.createElement("b",null,c)),r.a.createElement(re.a,{className:t.nodeTableData,align:"left"},o))})))))},ue=t(346),de=t(155),fe=t.n(de),pe=t(184),me=t.n(pe),ge=t(185),he=t.n(ge),be=t(350),ve=t(358),ye=Object(h.a)({root:{fontSize:"1rem"},button:{width:".005%",color:"white",backgroundColor:"#424242"},title:{fontSize:"25px",color:"#ffffff"},icon:{color:"#42C6FF",margin:"15px 0 0 10px"},expand:{color:"#42C6FF",margin:"0px"},header:{display:"flex"},table:{minWidth:450},lensName:{fontSize:"16px"},pagination:{margin:".5rem",backgroundColor:"#595959"}});function Ee(e){var n=ye();return r.a.createElement(r.a.Fragment,null,r.a.createElement(le.a,{key:e.uid},r.a.createElement(re.a,{component:"th",scope:"row"},r.a.createElement(ue.a,{className:n.lensName,onClick:function(){e.setLens(e.lens)}},e.lens_type+" :\t\t"+e.lens+"\t\t"+e.score))))}function we(e){var n=e.setLens,t=Object(a.useState)({toggled:!0,lenses:[],first:100,offset:0}),c=Object(p.a)(t,2),o=c[0],l=c[1],s=ye(),i=Object(a.useState)(0),u=Object(p.a)(i,2),f=u[0],m=u[1],g=Object(a.useState)(10),h=Object(p.a)(g,2),b=h[0],v=h[1];return Object(a.useEffect)((function(){var e=setInterval((function(){console.log("Fetching lenses"),Oe(o.first,o.offset).then((function(e){if(e.lenses&&e.lenses!==o.lenses){var n=o.lenses.concat(e.lenses);l(Object(d.a)(Object(d.a)({},o),{},{offset:o.offset+e.lenses.length||0,lenses:n}))}}))}),5e3);return function(){return clearInterval(e)}})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:s.header},r.a.createElement("b",{className:s.title},r.a.createElement(me.a,{className:s.icon}),"LENSES"),r.a.createElement(ue.a,{className:s.button,onClick:function(){l(Object(d.a)(Object(d.a)({},o),{},{toggled:!o.toggled}))}},r.a.createElement(fe.a,{className:s.expand}))),r.a.createElement("div",{className:"lensToggle"},o.toggled&&function(e,n,t,a,c,o,l){return r.a.createElement(ce.a,null,r.a.createElement(ve.a,{className:l.pagination,"aria-label":"pagination",rowsPerPageOptions:[5,10,25],component:"div",count:e.lenses.length,rowsPerPage:t,page:n,onChangePage:a,onChangeRowsPerPage:c}),e.lenses.slice(n*t,n*t+t).map((function(e){return r.a.createElement(te.a,{className:l.table,"aria-label":"lens table",key:Number(e.uid)},r.a.createElement(ae.a,null,r.a.createElement(Ee,{key:Number(e.uid),uid:e.uid,lens:e.lens_name,lens_type:e.lens_type,score:e.score,setLens:o})))})))}(o,f,b,(function(e,n){m(n)}),(function(e){console.log("Handle Row Event",e),v(parseInt(e.target.value,10)),m(0)}),n,s)),r.a.createElement(be.a,null))}var Oe=function(){var e=Object(f.a)(u.a.mark((function e(n,t){var a,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="\n        {\n            lenses(first: ".concat(n,", offset: ").concat(t,") {\n                uid,\n                node_key,\n                lens_name,\n                score, \n                lens_type,\n            }\n        }\n    "),e.next=3,fetch("/prod/graphQlEndpoint/graphql",{method:"post",body:JSON.stringify({query:a}),headers:{"Content-Type":"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){return e.errors&&(console.error("lenses failed",e.errors),e.data={lenses:[]}),e})).then((function(e){return e.data}));case 3:return r=e.sent,e.next=6,r;case 6:return c=e.sent,console.log("queried graphql_edge in engagement view content",c),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),je=function(e){var n=e.node;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{node:n}))};function xe(e){var n=e.curNode,t=Object(a.useState)(!0),c=Object(p.a)(t,2),o=c[0],l=c[1],s=ye();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",{className:s.header},r.a.createElement("b",{className:s.title},r.a.createElement(he.a,{className:s.icon})," NODE"),r.a.createElement(ue.a,{className:s.button,onClick:function(){l((function(e){return!e}))}},r.a.createElement(fe.a,{className:s.expand}))),r.a.createElement("div",{className:"nodeToggle"},o&&n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(je,{node:n})))))}function ke(e){var n=e.setLens,t=e.curNode;return r.a.createElement(r.a.Fragment,null,r.a.createElement(we,{setLens:n}),r.a.createElement(xe,{curNode:t}))}var Ne=t(6),_e=t(360),Se=t(351),Ce=t(348),Fe=t(349),Pe=t(347),Ie=t(186),Le=t.n(Ie),Ae=t(132),Te=t.n(Ae),Me=t(47),De=function(){var e=Object(f.a)(u.a.mark((function e(n){var t,a,r=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>1&&void 0!==r[1]?r[1]:"get",e.next=3,fetch(n,{method:t,credentials:"include",headers:new Headers({"Content-Type":"application/json"})}).catch((function(e){throw console.warn(e),new Error("Error: ".concat(e))}));case 3:return a=e.sent,e.abrupt("return",a.json());case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Re=function(){var e=Object(f.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,De("/prod/auth/checkLogin","post");case 3:return n=e.sent,e.abrupt("return","True"===n.success);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ze=Object(h.a)((function(e){return Object(b.a)({root:{display:"flex"},header:{justifyContent:"space-between"},link:{color:"#42C6FF",textDecoration:"none"}})})),Ue=function(e){var n=e.displayBtn,t=ze();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Se.a,{position:"static"},r.a.createElement(Ce.a,{className:t.header},r.a.createElement(Fe.a,{variant:"h6"},"GRAPL"),n&&r.a.createElement(Me.b,{to:"/",className:t.link},r.a.createElement(Te.a,null)))))},Be=t(352),qe=t(353),We=t(355),Ge=t(354),He=Object(h.a)({root:{maxWidth:345,postion:"fixed"},button:{border:"2px solid white",backgroundColor:"#42c6ff"}});function Je(){var e=He();return r.a.createElement(Be.a,{variant:"outlined",className:e.root},r.a.createElement(qe.a,null,r.a.createElement(Ge.a,null,r.a.createElement(Fe.a,{variant:"body2",color:"textSecondary",component:"p"},"You are not logged in and changes cannot be saved."))),r.a.createElement(We.a,null,r.a.createElement(ue.a,{className:e.button,size:"small",onClick:function(){window.history.replaceState("#/","","#/login"),window.location.reload()}},"Login")))}var Ve=Object(h.a)((function(e){return Object(b.a)({root:{display:"flex"},button:{backgroundColor:"#42C6FF",margin:"0.25rem",padding:"0.20rem"},loggedIn:{display:"flex",alignItems:"flex-end",justifyContent:"flex-end"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(500,"px)"),marginLeft:500,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2),color:"#42C6FF"},hide:{display:"none"},drawer:{width:500,flexShrink:0},drawerPaper:{width:500},drawerHeader:Object(d.a)(Object(d.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-500},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},lensName:{color:"#EAFDFF",fontSize:"1.5rem"},header:{fontSize:"35px"},headerContent:{width:"100vw",display:"flex",justifyContent:"space-between"},close:{color:"#42C6FF"},link:{color:"#42C6FF",textDecoration:"none"}})}));function Ye(e){var n=e.setLens,t=e.curLens,a=e.curNode,c=Ve(),o=r.a.useState(!0),l=Object(p.a)(o,2),s=l[0],i=l[1];return r.a.createElement("div",{className:c.root},r.a.createElement(Se.a,{position:"fixed",className:Object(Ne.a)(c.appBar,Object(k.a)({},c.appBarShift,s))},r.a.createElement(Ce.a,null,r.a.createElement(Pe.a,{color:"inherit","aria-label":"open drawer",onClick:function(){i(!0)},edge:"start",className:Object(Ne.a)(c.menuButton,s&&c.hide)},"\u2630"),r.a.createElement("div",{className:c.headerContent},r.a.createElement(Fe.a,{variant:"h5",noWrap:!0},r.a.createElement("b",{className:c.header}," GRAPL ")),r.a.createElement(Me.b,{to:"/",className:c.link},r.a.createElement(Te.a,null))))),r.a.createElement(_e.a,{className:c.drawer,variant:"persistent",anchor:"left",open:s,classes:{paper:c.drawerPaper}},r.a.createElement("div",{className:c.drawerHeader},r.a.createElement(ue.a,{onClick:function(){i(!1)}},r.a.createElement(Le.a,{className:c.close}))),r.a.createElement(be.a,null),r.a.createElement(ke,{setLens:n,curNode:a})),r.a.createElement("main",{className:Object(Ne.a)(c.content,Object(k.a)({},c.contentShift,s))},r.a.createElement("div",{className:c.drawerHeader}),r.a.createElement("h3",{className:c.lensName},t||""),r.a.createElement(Fe.a,{paragraph:!0})))}var Qe=function(){var e=Ve(),n=r.a.useState({curLens:"",curNode:null,loggedIn:!0,renderedOnce:!1}),t=Object(p.a)(n,2),c=t[0],o=t[1];Object(a.useEffect)((function(){if(!c.renderedOnce){var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re().then((function(e){e||console.warn("Logged out"),o(Object(d.a)(Object(d.a)({},c),{},{loggedIn:e||!1,renderedOnce:!0}))}));case 2:case"end":return e.stop()}}),e)}))),2e3);return function(){clearInterval(e)}}}),[c,o]);var l=c.loggedIn;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ye,{setLens:function(e){return o(Object(d.a)(Object(d.a)({},c),{},{curLens:e}))},curLens:c.curLens,curNode:c.curNode}),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e.loggedIn},l?"":r.a.createElement(Je,null)),r.a.createElement(ne,{lensName:c.curLens,setCurNode:function(e){o(Object(d.a)(Object(d.a)({},c),{},{curNode:e}))}})))},$e=t(187),Ke=Object(h.a)((function(e){return Object(b.a)({root:{display:"flex"},button:{backgroundColor:"#42C6FF",margin:"0.25rem",padding:"0.25rem"},welcome:{width:"70%",textAlign:"center",backgroundColor:"#373740",height:"100vh",color:"white"},loggedIn:{display:"flex",justifyContent:"flex-end"},nav:{margin:"2rem",width:"30%",display:"flex",flexDirection:"column"},dashboard:{display:"flex",flexDirection:"row"},link:{color:"white",textDecoration:"none",padding:".75rem",backgroundColor:"#42C6FF",margin:"1rem",textAlign:"center",borderRadius:".35rem",textTransform:"uppercase",fontWeight:"bolder"}})})),Xe=function(){var e=Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",De("/prod/auth/getNotebook","post").then((function(e){return e.success.notebook_url})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ze=Ke;function en(){var e=Object($e.a)(Xe,[]),n=Ze(),t=Object(a.useState)({loggedIn:!0,renderedOnce:!1}),c=Object(p.a)(t,2),o=c[0],l=c[1];Object(a.useEffect)((function(){if(!o.renderedOnce){var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re().then((function(e){e||console.warn("Logged out"),l({loggedIn:e||!1,renderedOnce:!0})}));case 2:case"end":return e.stop()}}),e)}))),2e3);return function(){clearInterval(e)}}}),[o,l]),console.log("state - loggedin",o.loggedIn);var s=o.loggedIn;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue,{displayBtn:!1}),r.a.createElement("div",{className:n.dashboard},r.a.createElement("section",{className:n.nav},r.a.createElement(Me.b,{to:"/engagements",className:n.link},"Engagements"),r.a.createElement(Me.b,{to:"/plugins",className:n.link},"Upload Plugin"),r.a.createElement(ue.a,{onClick:function(){!e.loading&&e.result?window.open(e.result):alert("sagemaker url not ready")},className:n.link},"Open Engagement Notebook")),r.a.createElement("section",{className:n.welcome},r.a.createElement("div",{className:n.loggedIn},s?"":r.a.createElement(Je,null)),r.a.createElement("h1",null," Welcome! "))))}var nn=Object(h.a)((function(e){return Object(b.a)({root:{display:"flex"},formContainer:{color:"white",margin:"1rem"},btn:{backgroundColor:"#42C6FF",margin:"0.25rem",padding:"0.25rem",borderRadius:"6px"},loggedIn:{display:"flex",justifyContent:"flex-end"},inputFiles:{border:"none",width:"35vw"},upload:{display:"flex"},succMsg:{color:"#03dac6"},errMsg:{color:"#CF6679"},pluginTable:{backgroundColor:"#292929",margin:"1em",width:"50%",height:"100%",boxShadow:" 1.5px 1.5px #000000"},uploadFormContainer:{backgroundColor:"#292929",margin:"1em",width:"50%",height:"100%",boxShadow:"1.5px 1.5px #000000",display:"flex"},uploadForm:{fontFamily:"Arial",display:"flex",fontSize:".75rem"}})})),tn=t(188),an=t.n(tn),rn=function(){var e=Object(f.a)(u.a.mark((function e(){var n,t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/prod/modelPluginDeployer/listModelPlugins",{method:"post",headers:{"Content-Type":"application/json"},credentials:"include"});case 2:return n=e.sent,e.next=5,n.json();case 5:return t=e.sent,e.prev=6,a=t.success.plugin_list,e.abrupt("return",a);case 11:return e.prev=11,e.t0=e.catch(6),console.warn(e.t0),e.abrupt("return",[]);case 15:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(){return e.apply(this,arguments)}}(),cn=function(){var e=Object(f.a)(u.a.mark((function e(n){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/prod/modelPluginDeployer/deleteModelPlugin",{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({plugins_to_delete:[n]})});case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),on=function(){var e=Object(f.a)(u.a.mark((function e(n){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/prod/modelPluginDeployer/deploy",{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.abrupt("return",a.success.Success);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ln=function(){var e=Object(f.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var a=new FileReader;return a.addEventListener("load",(function(n){if(null!==n.target){var a=n.target.result;if(null===a)return console.warn("Read pluginfile was null"),void t(null);e("string"===typeof a?a:(new TextDecoder).decode(a))}else console.warn("onload event was null")})),a.readAsText(n)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),sn=function(e){var n=e.status,t=nn();return!0===n?r.a.createElement("div",{className:t.succMsg},"Plugins Successfully Deployed!"):!1===n?r.a.createElement("div",{className:t.errMsg},"Upload Unsuccessful"):r.a.createElement("div",null)},un=function(){var e=r.a.useState({curFiles:null,success:null}),n=Object(p.a)(e,2),t=n[0],a=n[1],c=nn();return r.a.createElement("div",{className:c.formContainer},r.a.createElement("h4",null,"UPLOAD DIRECTORY WITH PLUGINS:"),r.a.createElement(g.c,{initialValues:{filename:""},onSubmit:function(e){var n={},r=[],c=t.curFiles;if(null!==c){var o,l=Object(F.a)(c);try{var s=function(){var e=o.value,t=ln(e).then((function(t){var a=e.webkitRelativePath||e.mozRelativePath;n[a]=t}));r.push(t)};for(l.s();!(o=l.n()).done;)s()}catch(u){l.e(u)}finally{l.f()}var i=!0;Promise.all(r).then((function(){return on({plugins:n})})).then((function(e){i=i&&e})).then((function(){return a(Object(d.a)(Object(d.a)({},t),{},{success:i}))}))}else console.warn("Attempted to upload files without selecting any")}},r.a.createElement(g.b,{className:c.uploadForm},r.a.createElement(g.a,{className:c.inputFiles,name:"plugin",directory:"",webkitdirectory:"",mozdirectory:"",type:"file",multiple:!0,placeholder:"Plugin",onChange:function(e){a(Object(d.a)(Object(d.a)({},t),{},{curFiles:e.currentTarget.files}))}}),r.a.createElement(ue.a,{className:"submitBtn",type:"submit"},r.a.createElement(an.a,{className:c.btn})))),r.a.createElement("br",null),r.a.createElement(sn,{status:t.success}))},dn=t(189),fn=t.n(dn),pn=function(){var e=nn(),n=r.a.useState({rows:[],toggle:!0}),t=Object(p.a)(n,2),c=t[0],o=t[1],l=Object(a.useState)(0),s=Object(p.a)(l,2),i=s[0],m=s[1],g=Object(a.useState)(10),h=Object(p.a)(g,2),b=h[0],v=h[1],y=b-Math.min(b,c.rows.length-i*b);return Object(a.useEffect)((function(){var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rn().then((function(e){o({toggle:c.toggle,rows:e})}));case 2:case"end":return e.stop()}}),e)}))),1e3);return function(){return clearInterval(e)}}),[c.toggle]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ce.a,null,r.a.createElement(te.a,null,r.a.createElement(oe.a,null,r.a.createElement(le.a,{key:"plugin"},r.a.createElement(re.a,{align:"left"},"PLUGINS"))),r.a.createElement(ae.a,{"aria-label":"PluginTable"},c.rows.slice(i*b,i*b+b).map((function(n){return r.a.createElement(le.a,{key:n},r.a.createElement(re.a,{align:"right"},n,r.a.createElement(ue.a,{onClick:function(){cn(n).then((function(){o(Object(d.a)(Object(d.a)({},c),{},{toggle:c.toggle&&!1})),console.log("Plugin Deleted")}))}},r.a.createElement(fn.a,{className:e.btn}))))})),y>0&&r.a.createElement(le.a,{style:{height:53*y}},r.a.createElement(re.a,{colSpan:6})))),r.a.createElement(ve.a,{"aria-label":"pagination",rowsPerPageOptions:[5,10,25],component:"div",count:c.rows.length,rowsPerPage:b,page:i,onChangePage:function(e,n){m(n)},onChangeRowsPerPage:function(e){console.log("Event",e),v(parseInt(e.target.value,10)),m(0)}})))},mn=function(){var e=nn(),n=Object(a.useState)({loggedIn:!0,renderedOnce:!1}),t=Object(p.a)(n,2),c=t[0],o=t[1];Object(a.useEffect)((function(){if(!c.renderedOnce){var e=setInterval(Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re().then((function(e){e||console.warn("Logged Out"),o({loggedIn:e||!1,renderedOnce:!0})}));case 2:case"end":return e.stop()}}),e)}))),2e3);return function(){clearInterval(e)}}}),[c,o]);var l=c.loggedIn;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue,{displayBtn:!0}),r.a.createElement("div",{className:e.loggedIn},l?"":r.a.createElement(Je,null)),r.a.createElement("div",{className:e.upload},r.a.createElement("div",{className:e.uploadFormContainer},r.a.createElement(un,null),r.a.createElement("div",{id:"message"})),r.a.createElement("div",{className:e.pluginTable},r.a.createElement(pn,null))))},gn=t(23);var hn=function(){return console.log("Grapl loaded"),r.a.createElement(Me.a,null,r.a.createElement(gn.c,null,r.a.createElement(gn.a,{exact:!0,path:"/login",component:E}),r.a.createElement(gn.a,{exact:!0,path:"/",component:en}),r.a.createElement(gn.a,{exact:!0,path:"/plugins",component:mn}),r.a.createElement(gn.a,{exact:!0,path:"/engagements",component:Qe})))};function bn(){return console.log("Grapl loaded"),r.a.createElement(r.a.Fragment,null,r.a.createElement(hn,null))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var vn=Object(l.a)({palette:{type:"dark",primary:{main:"#373740"}}}),yn=document.getElementById("root");o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Me.a,null,r.a.createElement(s.a,{theme:vn},r.a.createElement(bn,null),","))),yn),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[219,1,2]]]);
//# sourceMappingURL=main.b9d7f0ab.chunk.js.map