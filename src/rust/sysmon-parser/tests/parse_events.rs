#[test]
fn parse_events_events6() {
    // TODO(inickles): use data from the file under 'tests/data' directory after we move this
    // package to its own repo
    let xml = r#"
<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-Sysmon' Guid='{5770385F-C22A-43E0-BF4C-06F5698FFBD9}'/><EventID>16</EventID><Version>3</Version><Level>4</Level><Task>16</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime='2018-12-08T20:37:21.731546600Z'/><EventRecordID>1</EventRecordID><Correlation/><Execution ProcessID='2420' ThreadID='192'/><Channel>Microsoft-Windows-Sysmon/Operational</Channel><Computer>DESKTOP-34EOTDT</Computer><Security UserID='S-1-5-21-1250129843-4184514636-4148823746-1001'/></System><EventData><Data Name='UtcTime'>2018-12-08 20:37:21.716</Data><Data Name='Configuration'>C:\Users\andy\Downloads\Sysmon\Sysmon.exe  -i</Data><Data Name='ConfigurationFileHash'></Data></EventData></Event>
<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-Sysmon' Guid='{5770385F-C22A-43E0-BF4C-06F5698FFBD9}'/><EventID>3</EventID><Version>5</Version><Level>4</Level><Task>3</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime='2018-12-08T20:39:26.825801900Z'/><EventRecordID>37</EventRecordID><Correlation/><Execution ProcessID='6832' ThreadID='4836'/><Channel>Microsoft-Windows-Sysmon/Operational</Channel><Computer>DESKTOP-34EOTDT</Computer><Security UserID='S-1-5-18'/></System><EventData><Data Name='RuleName'></Data><Data Name='UtcTime'>2018-12-08 20:39:25.605</Data><Data Name='ProcessGuid'>{331D737B-26FE-5C0B-0000-00101C0B0100}</Data><Data Name='ProcessId'>340</Data><Data Name='Image'>C:\Windows\System32\svchost.exe</Data><Data Name='User'>NT AUTHORITY\NETWORK SERVICE</Data><Data Name='Protocol'>udp</Data><Data Name='Initiated'>true</Data><Data Name='SourceIsIpv6'>true</Data><Data Name='SourceIp'>a00:20f:0:0:b851:5be9:e0:ffff</Data><Data Name='SourceHostname'></Data><Data Name='SourcePort'>59197</Data><Data Name='SourcePortName'></Data><Data Name='DestinationIsIpv6'>true</Data><Data Name='DestinationIp'>a00:203:6100:6e00:7400:6900:6e00:6500</Data><Data Name='DestinationHostname'></Data><Data Name='DestinationPort'>53</Data><Data Name='DestinationPortName'>domain</Data></EventData></Event>
<Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>5</EventID><Version>3</Version><Level>4</Level><Task>5</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-01-04T19:52:55.677224000Z"/><EventRecordID>9</EventRecordID><Correlation/><Execution ProcessID="49514" ThreadID="49514"/><Channel>Linux-Sysmon/Operational</Channel><Computer>user-VirtualBox</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-01-04 19:52:55.682</Data><Data Name="ProcessGuid">{49e2a5f6-a597-61d4-5d6a-98d813560000}</Data><Data Name="ProcessId">49520</Data><Data Name="Image">/usr/bin/systemctl</Data><Data Name="User">user</Data></EventData></Event>
<Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-01-04T19:52:55.677905000Z"/><EventRecordID>10</EventRecordID><Correlation/><Execution ProcessID="49514" ThreadID="49514"/><Channel>Linux-Sysmon/Operational</Channel><Computer>user-VirtualBox</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-01-04 19:52:55.682</Data><Data Name="ProcessGuid">{49e2a5f6-a597-61d4-5d7a-861de5550000}</Data><Data Name="ProcessId">49521</Data><Data Name="Image">/usr/bin/systemctl</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">systemctl --system --full --no-legend --no-pager list-units --all sys*</Data><Data Name="CurrentDirectory">/home/user/SysmonForLinux/build</Data><Data Name="User">user</Data><Data Name="LogonGuid">{49e2a5f6-0000-0000-e803-000000000000}</Data><Data Name="LogonId">1000</Data><Data Name="TerminalSessionId">3</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{00000000-0000-0000-0000-000000000000}</Data><Data Name="ParentProcessId">49518</Data><Data Name="ParentImage">-</Data><Data Name="ParentCommandLine">-</Data><Data Name="ParentUser">-</Data></EventData></Event>
<Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>5</EventID><Version>3</Version><Level>4</Level><Task>5</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-01-04T19:52:55.683744000Z"/><EventRecordID>11</EventRecordID><Correlation/><Execution ProcessID="49514" ThreadID="49514"/><Channel>Linux-Sysmon/Operational</Channel><Computer>user-VirtualBox</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-01-04 19:52:55.688</Data><Data Name="ProcessGuid">{49e2a5f6-a597-61d4-5d7a-861de5550000}</Data><Data Name="ProcessId">49521</Data><Data Name="Image">/usr/bin/systemctl</Data><Data Name="User">user</Data></EventData></Event>
"#;

    assert_eq!(sysmon_parser::parse_events(xml).count(), 5);

    assert!(sysmon_parser::parse_events(xml).all(|res| res.is_ok()));
}
